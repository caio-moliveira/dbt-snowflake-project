version: 2

models:
  - name: revenue_by_author
    description: "Calculates total revenue and books sold by each author, aggregating data from book sales and pricing."
    tags:
      - sales
      - revenue
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: author_name
        description: "Name of the author, standardized to uppercase."
        tests:
          - not_null
          - unique
      - name: total_revenue
        description: "Total revenue generated by the author's books."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold by the author."
        tests:
          - not_null
          - accepted_range:
              min: 0

  - name: revenue_by_publisher
    description: "Calculates total revenue and books sold by each publisher, aggregated from author and book data."
    tags:
      - sales
      - revenue
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: publisher_name
        description: "Name of the publisher."
        tests:
          - not_null
          - unique
      - name: total_revenue
        description: "Total revenue generated by the publisher's books."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold by the publisher."
        tests:
          - not_null
          - accepted_range:
              min: 0

  - name: sales_by_genre
    description: "Aggregates sales data by book genre, including revenue, units sold, and the number of distinct books."
    tags:
      - sales
      - genre
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: genre
        description: "Genre of the books, derived from Google Books metadata."
        tests:
          - not_null
      - name: total_revenue
        description: "Total revenue generated by books in this genre."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold in this genre."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books
        description: "Total number of distinct books in this genre."
        tests:
          - not_null

  - name: top_selling_authors
    description: "Identifies the top-selling authors based on revenue and total books sold."
    tags:
      - sales
      - top_performers
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: author_id
        description: "Unique identifier for the author."
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('dim_authors')
              field: author_id
      - name: author_name
        description: "Name of the author."
        tests:
          - not_null
      - name: publisher_group
        description: "Name of the Publisher Groups."
        tests:
          - not_null
      - name: avg_rating
        description: "Average Rating of authors."
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 5
      - name: total_revenue
        description: "Total revenue generated by the author's books."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold by the author."
        tests:
          - not_null
          - accepted_range:
              min: 0

  - name: top_selling_books_by_year

    description: "Identifies the top-selling books for each year based on revenue and units sold."
    tags:
      - sales
      - yearly_trends
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: sales_year
        description: "Year in which the book sales occurred."
        tests:
          - not_null
          - accepted_values:
              values: [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025]
      - name: ISBN
        description: "Unique identifier for the book."
        tests:
          - not_null
      - name: title
        description: "Title of the book."
        tests:
          - not_null
      - name: total_revenue
        description: "Total revenue generated by the book in the given year."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of copies sold for the book in the given year."
        tests:
          - not_null
          - accepted_range:
              min: 0

  - name: top_selling_publishers
    description: "Identifies the top-selling publishers based on revenue and total books sold."
    tags:
      - sales
      - top_performers
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: publisher_group
        description: "Publisher groups names."
        tests:
          - not_null
          - unique
      - name: avg_rating
        description: "Average Rating of authors."
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 5
      - name: total_revenue
        description: "Total revenue generated by the author's books."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold by the author."
        tests:
          - not_null
          - accepted_range:
              min: 0

  - name: yearly_sales_trends
    description: "Analyzes yearly sales trends, including total revenue, units sold, and unique books sold."
    tags:
      - sales
      - yearly_trends
    meta:
      owner: "analytics_team"
      sla: "Data updated daily at 6 AM"
    columns:
      - name: sales_year
        description: "Year in which the sales occurred."
        tests:
          - not_null
      - name: total_revenue
        description: "Total revenue generated in the year."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: total_books_sold
        description: "Total number of books sold in the year."
        tests:
          - not_null
          - accepted_range:
              min: 0
      - name: unique_books_sold
        description: "Total number of unique books sold in the year."
        tests:
          - not_null
          - accepted_range:
              min: 0
